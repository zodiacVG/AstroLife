# 字体引入SOP

## 概述
本文档记录了在AstroLife项目中引入自定义字体的标准操作流程(SOP)，特别是针对中英文混排场景的字体选择和集成方法。

## 字体选择标准

### 适合终端界面的字体特性
1. **等宽特性**：中英文字符宽度比例协调，确保对齐整齐
2. **点阵风格**：适合终端风格的界面设计，增强复古感
3. **中英文支持**：完整支持中文字符集，同时与英文字符风格统一
4. **可读性**：在不同大小下保持清晰可读
5. **开源许可**：优先选择开源免费且可商用的字体

### 推荐字体列表
1. **文泉驿正黑 (WenQuanYi Zen Hei)**
   - 特点：经典开源中文字体，适合终端显示
   - CDN：可通过ZeoSeven Fonts CDN引入
   - 适用场景：通用中英文混排终端界面

2. **霞鹜文楷等宽版 (LXGW WenKai Mono)**
   - 特点：楷体风格，等宽设计，支持中英文
   - CDN：可通过npm.elemecdn.com引入
   - 适用场景：需要独特风格的中英文混排界面

3. **Sarasa Term SC**
   - 特点：专为终端环境设计的等宽字体，严格的2:1中英文字宽比例
   - CDN：可通过GitHub仓库和jsDelivr CDN引入
   - 适用场景：需要严格对齐的中英文代码和终端界面

## 字体引入流程

### 步骤1：选择字体
1. 根据项目风格和需求从推荐字体列表中选择
2. 确认字体的开源许可和Web支持情况

### 步骤2：查找CDN资源
1. 优先查找已有的WebFont CDN链接
2. 若无直接可用的WebFont CDN，尝试以下方法：
   - 查找字体的GitHub仓库
   - 使用jsDelivr CDN引用GitHub仓库中的字体文件
   - 格式：`https://cdn.jsdelivr.net/gh/用户名/仓库名@版本号/文件路径`

### 步骤3：CSS集成
#### 方法1：使用@import引入CDN样式（推荐）
```css
/* 字体名称 */
@import url('CDN链接');
```

#### 方法2：使用@font-face引入字体文件
```css
@font-face {
  font-family: '字体名称';
  src: url('字体文件链接') format('truetype');
  font-display: swap;
}
```

### 步骤4：应用字体
1. 在CSS变量中定义字体：
```css
:root {
  --ao-font-cjk: '新字体名称', '备用字体1', '备用字体2', system-ui;
}
```
2. 确保所有需要使用该字体的元素正确引用CSS变量
3. 特别注意终端风格元素（如.ao-console-bar）的字体设置

### 步骤5：测试验证
1. 在浏览器中检查字体是否正确加载
2. 验证中英文混排效果
3. 确认字体大小和对齐是否一致
4. 检查不同设备上的显示效果

## 常见问题解决

### 问题1：字体无法加载
- **现象**：浏览器控制台显示字体加载失败
- **原因**：CDN链接不正确或浏览器阻止了跨域资源
- **解决方案**：
  1. 检查CDN链接是否正确
  2. 尝试使用@font-face代替@import
  3. 确保字体文件格式正确（TTF、WOFF、WOFF2等）

### 问题2：中英文字符大小不一致
- **现象**：中英文字符显示大小不匹配
- **原因**：字体未正确设置或字体本身设计问题
- **解决方案**：
  1. 确保使用等宽字体
  2. 检查CSS中是否正确设置了字体族
  3. 尝试调整font-size或使用特定的字体变体

### 问题3：字体回退机制不生效
- **现象**：当主字体无法加载时，没有正确回退到备用字体
- **原因**：CSS中的字体族设置不正确
- **解决方案**：
  1. 确保字体族列表中包含多个备用字体
  2. 最后一个备用字体应为通用字体族（如system-ui）

## 最佳实践

1. **字体回退机制**：始终提供多个备用字体，确保在任何情况下都能正常显示
2. **性能优化**：考虑使用WOFF或WOFF2格式的字体文件，它们比TTF更小
3. **加载策略**：使用`font-display: swap`确保字体加载期间文本可见
4. **测试覆盖**：在不同浏览器和设备上测试字体显示效果
5. **文档记录**：记录所使用字体的名称、版本和来源，便于后续维护

## 参考资源

- [Google Fonts](https://fonts.google.com/)
- [jsDelivr CDN](https://www.jsdelivr.com/)
- [ZeoSeven Fonts](https://fonts.zeo7.com/)
- [霞鹜文楷GitHub仓库](https://github.com/lxgw/LxgwWenKai)
- [Sarasa Gothic GitHub仓库](https://github.com/be5invis/Sarasa-Gothic)